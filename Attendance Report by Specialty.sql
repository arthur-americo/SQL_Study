'It retrieves information about hospital attendances from a hospital database, including the hospital ID, attendance ID, 
attendance type, attendance date, patient ID, patient name, attendance origin ID, attendance origin description, 
specialty ID, specialty description, and the type of specialty (medical, oncological, multi, or error). 
The results are filtered by attendance date, attendance type, and hospital ID, and are ordered by hospital ID and specialty ID.'
SELECT
    HOSPITAL.ID AS HOSPITAL_ID,
    ATTENDANCE.ID AS ATTENDANCE_ID,
    ATTENDANCE.TYPE AS ATTENDANCE_TYPE,
    TO_CHAR(ATTENDANCE.DATE,'YYYY-MM-DD') AS ATTENDANCE_DATE,
    PATIENT.ID AS PATIENT_ID,
    PATIENT.NAME AS PATIENT_NAME,
    ATTENDANCE_ORIGIN.ID AS ATTENDANCE_ORIGIN_ID,
    ATTENDANCE_ORIGIN.DESCRIPTION AS ATTENDANCE_ORIGIN_DESCRIPTION,
    SPECIALTY.ID AS SPECIALTY_ID,
    SPECIALTY.DESCRIPTION AS SPECIALTY_DESCRIPTION,
CASE
    WHEN SPECIALTY.ID IN (
        4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,31,33,34,35,36,37,38,39,40,41,42,
        43,44,46,47,48,50,51,52,56,58,59,60,61,63,68,72,73,74,75,76,82,84,92,93,96,98
        ) THEN 'MEDICAL'
    WHEN SPECIALTY.ID IN (
        17,32,78
    ) THEN 'ONCOLOGICAL'
    WHEN SPECIALTY.ID IN (
        0,1,2,3,30,45,49,53,54,55,57,62,64,65,66,67,69,70,71,77,79,80,81,83,85,86,87,88,89,90,91,94,95,97,99
        ) THEN 'MULTI'
    ELSE 'ERROR'
    END AS SPECIALTY_TYPE
FROM HOSPITAL
    LEFT JOIN ATTENDANCE ON HOSPITAL.ID = ATTENDANCE.HOSPITAL_ID
    LEFT JOIN PATIENT ON ATTENDANCE.PATIENT_ID = PATIENT.ID
    LEFT JOIN ATTENDANCE_ORIGIN ON ATTENDANCE.ATTENDANCE_ORIGIN_ID = ATTENDANCE_ORIGIN.ID
    LEFT JOIN SPECIALTY ON ATTENDANCE.SPECIALTY_ID = SPECIALTY.ID
WHERE TRUNC(ATTENDANCE.DATE) = TO_DATE($IAString01$,'YYYY-MM-DD')
    AND  ATTENDANCE.TYPE IN ('A')
    AND HOSPITAL.ID IN (16,21,26)
ORDER BY
    HOSPITAL.ID,
    SPECIALTY.ID